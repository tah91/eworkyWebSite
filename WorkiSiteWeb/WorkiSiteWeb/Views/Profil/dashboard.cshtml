@model Worki.Data.Models.ProfilDashboardModel

@section HeadContent
{
	<title>@Html.WorkiTitle(Model.Member.GetDisplayName())</title>
    <link href="@Url.VersionedContent(Links.Content.Profil_min_css)" rel="stylesheet" type="text/css" />
    <link href="@Url.VersionedContent(Links.Content.rateit_min_css)" rel="stylesheet" type="text/css" />
}

@{
	var title = Model.IsPrivate ? Worki.Resources.Views.Profile.ProfileString.MyProfile : Model.Member.GetDisplayName();
	ViewData[Comment.DisplayRelatedLocalisation] = true;
}
@RazorHelpers.TitleDiv(title, "Blue")

<div class="detailContent">
    @{Html.RenderAction(MVC.Profil.ProfilMenu(Model.Member.MemberId, (int)ProfilConstants.ProfilItem.CommunityActivity, Model.IsPrivate));}

    <div class="profilDetailRight dashedLeft blockContainer float-right">
        <div class="profilLocalisations contentBlock">
            <ul class="tabs">
                <li><a href="#favoritesTab" class="bold">@Worki.Resources.Views.Profile.ProfileString.Favorite</a></li>
                <li><a href="#addedLocalisationTab" class="bold">@Worki.Resources.Views.Profile.ProfileString.MySpaces</a></li>
				@if (Model.IsPrivate)
				{
				<li><a href="#myCommentsTab" class="bold">@Worki.Resources.Views.Profile.ProfileString.MyComments</a></li>
				<li><a href="#locCommentsTab" class="bold">@Worki.Resources.Views.Profile.ProfileString.MyCommentedSpaces</a></li>
				}
            </ul>
            <div class="tab_container">
                <div id="favoritesTab" class="tab_content localisationsTagContainer">
					@if(Model.FavoriteLocalisations.Count != 0)
					{
						ViewData[ProfilConstants.TabId] = ProfilConstants.DashboardTab.FavLoc;
						@Html.Partial(MVC.Profil.Views._LocalisationTab)
					}
                    else if (Model.IsPrivate)
                    {
						<span class="italic">@Worki.Resources.Views.Profile.ProfileString.FavoriteSpacesEmpty</span>
                    }
                    else
                    {
                        <span class="italic">@Model.Member.MemberMainData.FirstName @Model.Member.MemberMainData.LastName @Worki.Resources.Views.Profile.ProfileString.FavoriteSpacesEmptyPublic</span>
                    }
                </div> 
                <div id="addedLocalisationTab" class="tab_content localisationsTagContainer visuallyhidden">
					@if (Model.AddedLocalisations.Count != 0)
                    {
						ViewData[ProfilConstants.TabId] = ProfilConstants.DashboardTab.AddedLoc;
						@Html.Partial(MVC.Profil.Views._LocalisationTab)
                    }
                    else if (Model.IsPrivate)
                    {
						<span class="italic">@Html.Raw(string.Format(Worki.Resources.Views.Profile.ProfileString.AddedSpacesEmpy, Html.ActionLink(Worki.Resources.Views.Home.FaqString.ClickHere, MVC.Home.AddSpace())))</span>
                    }
                     else
                     {
                        <span class="italic">@Model.Member.MemberMainData.FirstName @Model.Member.MemberMainData.LastName @Worki.Resources.Views.Profile.ProfileString.AddedSpacesEmptyPublic</span>
                     }
                </div> 
				@if (Model.IsPrivate)
				{
                <div id="myCommentsTab" class="tab_content visuallyhidden">
					@if (Model.PostedComments.Count != 0)
                    {
						ViewData[ProfilConstants.TabId] = ProfilConstants.DashboardTab.PostedCom;
						@Html.Partial(MVC.Profil.Views._CommentTab)
                    }
                    else
                    {
						<span class="italic">@Worki.Resources.Views.Profile.ProfileString.CommentsEmpy</span>
                    }					
                </div> 
                <div id="locCommentsTab" class="tab_content visuallyhidden">
					@if (Model.RelatedComments.Count != 0)
                    {
						ViewData[ProfilConstants.TabId] = ProfilConstants.DashboardTab.RelCom;
						@Html.Partial(MVC.Profil.Views._CommentTab)
                    }
                    else
                    {
						<span class="italic">@Worki.Resources.Views.Profile.ProfileString.RelCommentsEmpty</span>
                    }					
                </div> 
				}
            </div>
            <div class="clear">
            </div>
        </div>
        <div class="profilCompany contentBlock">
            <ul class="tabs">
                <li><a href="#companyTab" class="bold">@Worki.Resources.Views.Profile.ProfileString.MyCompany</a></li>
                <li><a href="#favPlacesTab" class="bold">@Worki.Resources.Views.Profile.ProfileString.MyFavoritePlaces</a></li>
            </ul>
            <div class="tab_container">
                <div id="companyTab" class="tab_content">
					@if (!string.IsNullOrEmpty(Model.Member.MemberMainData.CompanyName))
                    {
						@Model.Member.MemberMainData.CompanyName
                        if (Model.Member.MemberMainData.Website != null)
                        {
                            <br/><a href="@WebHelper.GetWebsite(Model.Member.MemberMainData.Website)">@Worki.Resources.Views.Profile.ProfileString.MyWebsite</a>
                        }
                    }
                    else if (Model.IsPrivate)
                    {
						<span class="italic">@Html.Raw(string.Format(Worki.Resources.Views.Profile.ProfileString.InfosEmpty, Html.ActionLink(Worki.Resources.Views.Home.FaqString.ClickHere, MVC.Profil.Edit())))</span>
                    }
                    else
                    {
                        <span class="italic">@Model.Member.MemberMainData.FirstName @Model.Member.MemberMainData.LastName @Worki.Resources.Views.Profile.ProfileString.MyCompanyPublic</span>
                    }                    
                </div> 
                <div id="favPlacesTab" class="tab_content visuallyhidden">
					@if (!string.IsNullOrEmpty(Model.Member.MemberMainData.FavoritePlaces))
                    {
						@Model.Member.MemberMainData.FavoritePlaces
                    }
                    else if (Model.IsPrivate)
                    {
						<span class="italic">@Html.Raw(string.Format(Worki.Resources.Views.Profile.ProfileString.InfosEmpty, Html.ActionLink(Worki.Resources.Views.Home.FaqString.ClickHere, MVC.Profil.Edit())))</span>
                    }
                    else
                    {
                        <span class="italic">@Model.Member.MemberMainData.FirstName @Model.Member.MemberMainData.LastName @Worki.Resources.Views.Profile.ProfileString.MyCompanyPublic</span>
                    }
                </div> 
            </div>
            <div class="clear">
            </div>
        </div>
    </div>
    <div class="clear">
    </div>
</div>

@section ScriptContent
{
    <script type="text/javascript">
        require(["@Url.VersionedContent(Links.Scripts.jquery_rateit_js)", "@Url.VersionedContent(Links.Scripts.tabs_js)"], function () {
                InitTab(".profilLocalisations");
                InitTab(".profilCompany");
                InitTab(".profilComments");

                function GetInt(str){
				    var intVal = parseInt(str);
				    if(isNaN(intVal))
					    return 1;
				    else
					    return intVal;
			    };
			
			    function AjaxFill(tabId,p1,p2,p3,p4,divId) {					
                    $.ajax({
					    url: "@Url.Action(MVC.Profil.ActionNames.AjaxDashboard)",
					    data: { "id": @Model.Member.MemberId, "tabId" : tabId, "p1" : p1, "p2" : p2, "p3" : p3, "p4" : p4 },
					    success: function (data) {
						    $(divId).html(data);
					    }
				    });
                };

			    $(".FavLoc").live("click", function () {

				    var p1 = GetInt($(this).html());
				    var p2 = GetInt($(".AddedLoc .selected").html());
				    var p3 = GetInt($(".PostedCom .selected").html());
				    var p4 = GetInt($(".RelCom .selected").html());

				    AjaxFill(@((int)ProfilConstants.DashboardTab.FavLoc),p1,p2,p3,p4,"#favoritesTab");
				    return false;
			    });
			    $(".AddedLoc").live("click", function () {

				    var p1 = GetInt($(".FavLoc .selected").html());
				    var p2 = GetInt($(this).html());
				    var p3 = GetInt($(".PostedCom .selected").html());
				    var p4 = GetInt($(".RelCom .selected").html());

				    AjaxFill(@((int)ProfilConstants.DashboardTab.AddedLoc),p1,p2,p3,p4,"#addedLocalisationTab");
				    return false;
			    });
			    $(".PostedCom").live("click", function () {

				    var p1 = GetInt($(".FavLoc .selected").html());
				    var p2 = GetInt($(".AddedLoc .selected").html());
				    var p3 = GetInt($(this).html());
				    var p4 = GetInt($(".RelCom .selected").html());

				    AjaxFill(@((int)ProfilConstants.DashboardTab.PostedCom),p1,p2,p3,p4,"#myCommentsTab");
				    return false;
			    });
			    $(".RelCom").live("click", function () {

				    var p1 = GetInt($(".FavLoc .selected").html());
				    var p2 = GetInt($(".AddedLoc .selected").html());
				    var p3 = GetInt($(".PostedCom .selected").html());
				    var p4 = GetInt($(this).html());

				    AjaxFill(@((int)ProfilConstants.DashboardTab.RelCom),p1,p2,p3,p4,"#locCommentsTab");
				    return false;
			    });
        });
    </script>
}