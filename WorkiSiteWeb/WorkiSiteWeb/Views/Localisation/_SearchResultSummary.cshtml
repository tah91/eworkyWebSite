@model Worki.Data.Models.SearchSingleResultViewModel

<div class="contentBlock resultItem">
    @{  
        RouteValueDictionary  rvd = new RouteValueDictionary(ViewContext.RouteData.Values);
        foreach (string key in Request.QueryString.Keys)
        {
            rvd[key] = Request.QueryString[key].ToString();
        }
        rvd["index"] = Model.Index;
        ViewData["link"] = Url.Action(MVC.Localisation.ActionNames.FullSearchResultDetail, MVC.Localisation.Name, rvd);
    }
    <div class="resultItemGallery picBack borderRadius float-left">
    @if (!string.IsNullOrEmpty(Model.Localisation.GetMainPic()))
    {
		@*<a href="@ViewData["link"]">*@
		@RazorHelpers.CenterImage(ControllerHelpers.GetUserImagePath(Model.Localisation.GetMainPic(), true), Model.Localisation.Name)
        @*</a>*@
    }
    </div>
    <div class="itemDetailsDiv float-left relative">
        <p class="green noUnderline"><span class="itemName">@Html.ActionLink(Model.Localisation.Name, MVC.Localisation.ActionNames.FullSearchResultDetail, rvd)</span>&nbsp; - &nbsp;@String.Format("{0:0.##} km", Model.Distance)</p>
        <span class="itemAddress">@Model.Localisation.Adress&nbsp; - &nbsp;@Model.Localisation.PostalCode @Model.Localisation.City</span>
        <span class="bold lightblue">@Localisation.LocalisationTypes[Model.Localisation.TypeValue]</span> - <span class="itemDesc">@Html.TruncateAtWord(Model.Localisation.Description, 80)</span><br />
        <div class="itemLogos bottom">
          @Html.Partial(MVC.Localisation.Views._IconeServices, Model.Localisation)
          <div class="clear">
          </div>
        </div>
    </div>

    <div class="itemCommDiv float-right">
		<div class="commentBgd">
			<div class="commentContainer">
				<div class="ratingContainer">
					@Html.ReadOnlyRating(Model.Localisation.GetRatingAverage(RatingType.General))<span class="lightblue noUnderline"><a href="@(ViewData["link"] + "#commentFormDiv")">@(Model.Localisation.Comments.Count.ToString() + " avis")</a></span>
					<div class="clear">
					</div> 
				</div>
				@{
					int index = 0;
					foreach (var com in Model.Localisation.Comments)
					{
						if (com.Member == null)
						{ 
							continue;
						}
						if (index++ >= 2)
						{
							break;
						}
						<p>&laquo; @Html.TruncateAtWord(com.Post,50)&raquo; <span class="commentUser bold">@com.Member.GetDisplayName()</span>
						</p>
					}
				}
			</div>
			<div class="clear">
			</div>
		</div>
    </div>
</div>
