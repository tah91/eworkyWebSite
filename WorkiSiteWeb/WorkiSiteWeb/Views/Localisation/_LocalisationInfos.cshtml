@model Worki.Data.Models.Localisation

<div class="contentBlock">
	<h3 class="blue">@Worki.Resources.Views.Localisation.LocalisationFormString.Access</h3>
	<div class="localisationMap">
		@Html.Partial(MVC.Shared.Views._Map, Model.GetMapModel())
	</div>
	@if (Model.HasAccesField())
	{
		<div class="localisationAccessDetail">
		@if (!string.IsNullOrEmpty(Model.PublicTransportation))
		{
			<span class="bold">@Worki.Resources.Models.Localisation.Localisation.PublicTransportation : </span>
			@Model.PublicTransportation<br />
		}
		@if (!string.IsNullOrEmpty(Model.RoadAccess))
		{
			<span class="bold">@Worki.Resources.Models.Localisation.Localisation.RoadAccess : </span>
			@Model.RoadAccess<br />
		}
		@if (!string.IsNullOrEmpty(Model.Station))
		{
			<span class="bold">@Worki.Resources.Models.Localisation.Localisation.Station : </span>
			@Model.Station<br />
		}
		</div>
	}
</div>
<div class="contentBlock">
	<h3 class="blue">Tarifs</h3>
	<div class="offerPrice">
		<ul>
			@foreach (var item in Model.GetPricedOffers())
			{
				<li>
					<div class="float-left">
						@Html.ActionLink(item.Name, MVC.Localisation.Offers(item.LocalisationId, (int)item.Type))
					</div>
					<div class="float-right">
						@item.GetPriceDisplay()
					</div>
					<div class="clear">
					</div>
				</li>
			}
		</ul>
	</div>
</div>
@*            <div class="contentBlock">
	<h3 class="blue">Recommendé par</h3>
	<div class="commentAvatar borderedImg float-left">
	@RazorHelpers.CenterImage(ControllerHelpers.GetUserImagePath(Model.Member.MemberMainData.Avatar, true), Model.Member.GetDisplayName())
	</div>
	<span class="boldLink blue">@Html.ActionLink(Model.Member.GetDisplayName(), MVC.Account.Public(Model.Member.MemberId))</span><br />
	@if (Model.HasFeature(Feature.LocalisationOwner))
	{	 
		<span>@FeatureHelper.Display(Feature.LocalisationOwner,Model)</span>
	}
	<div class="clear">
	</div>
</div>*@
@if (Roles.IsUserInRole(MiscHelpers.AdminConstants.AdminRole))
{
   
	<div class="contentBlock">
		<h3 class="blue">@Worki.Resources.Views.Shared.SharedString.InfoAdmin</h3>
		@{
			var lastEdition = Model.GetLastEdition();
			var creation = Model.GetCreation();
		}
		@if (creation != null)
		{
			<span class="bold">@Worki.Resources.Views.Localisation.LocalisationString.AddBy</span><span class="boldLink blue">@Html.ActionLink(creation.Member.GetDisplayName(), MVC.Account.Public(creation.Member.MemberId))</span><br />
			<span class="bold">@Worki.Resources.Views.Localisation.LocalisationString.TheDate</span>@Html.DisplayLocalDate(creation.ModificationDate)<br />
		}
		else
		{ 
			<span class="bold">@Worki.Resources.Views.Localisation.LocalisationString.AddBy</span><span class="boldLink blue">@Html.ActionLink(Model.Member.GetDisplayName(), MVC.Account.Public(Model.Member.MemberId))</span><br />
		}
		@if (lastEdition != null)
		{
			<span class="bold">@Worki.Resources.Views.Localisation.LocalisationString.LastEditBy</span><span class="boldLink blue">@Html.ActionLink(lastEdition.Member.GetDisplayName(), MVC.Account.Public(lastEdition.Member.MemberId))</span><br />
			<span class="bold">@Worki.Resources.Views.Localisation.LocalisationString.TheDate</span>@Html.DisplayLocalDate(lastEdition.ModificationDate)<br />
        }
        @if (Model.HasOwner() && Model.OwnerID.HasValue)
        {
            <span class="bold">@Worki.Resources.Views.Localisation.LocalisationString.OwnerIdentity</span><span class="boldLink blue">@Html.ActionLink(Worki.Resources.Views.Admin.AdminString.Owner, MVC.Account.Public(Model.OwnerID.Value))</span><br />
        }
        @if (Model.MainLocalisation != null)
        {
            <span class="bold">@Worki.Resources.Views.Admin.AdminString.Stickers : </span><span class="boldLink blue">@(Model.MainLocalisation.HasSticker ? Worki.Resources.Views.Shared.SharedString.Yes: Worki.Resources.Views.Shared.SharedString.No)</span><br />
        }
	</div>
}
<div class="localisationMiscRatings contentBlock">
	<h3 class="blue">@Worki.Resources.Views.Localisation.LocalisationString.EworkersOpinion</h3>
	<table>
		<tr>
			<td>
				<div itemprop="aggregateRating" itemscope itemtype="http://schema.org/AggregateRating">
					@RazorHelpers.ReadOnlyRating(Model.GetRatingAverage(RatingType.General))&nbsp;&nbsp;
					<meta itemprop="ratingCount" content ="@Model.Comments.Count">
					<meta itemprop="reviewCount" content ="@Model.Comments.Count">
				</div>
			</td>
			<td>
				<span class="bold">@Worki.Resources.Views.Localisation.LocalisationString.GeneralOpinion</span>
			</td>                    
		</tr>
		@if (Model.IsFreeLocalisation())
  {
		<tr>
			<td>
				@RazorHelpers.ReadOnlyRating(Model.GetRatingAverage(RatingType.Price))&nbsp;&nbsp;
			</td>
			<td>
				@Worki.Resources.Models.Localisation.Localisation.RatingPrice
			</td>                    
		</tr>
		<tr>
			<td>
				@RazorHelpers.ReadOnlyRating(Model.GetRatingAverage(RatingType.Wifi))&nbsp;&nbsp;
			</td>
			<td>
				@Worki.Resources.Models.Localisation.Localisation.RatingWifi
			</td>                    
		</tr>
		<tr>
			<td>
				@RazorHelpers.ReadOnlyRating(Model.GetRatingAverage(RatingType.Dispo))&nbsp;&nbsp;
			</td>
			<td>
				@Worki.Resources.Models.Localisation.Localisation.RatingDispo
			</td>                    
		</tr>
		<tr>
			<td>
				@RazorHelpers.ReadOnlyRating(Model.GetRatingAverage(RatingType.Welcome))&nbsp;&nbsp;
			</td>
			<td>
				@Worki.Resources.Models.Localisation.Localisation.RatingWelcome
			</td>                    
		</tr>
  }
	</table>
	@{
        var haveAvoid = Model.GetAvoidString();
        if (!string.IsNullOrEmpty(haveAvoid))
        {
		<span class="bold">@Worki.Resources.Views.Localisation.LocalisationFormString.AvoidPeriods : </span>@haveAvoid
        }
	}
</div>
@if (!(Model.IsFreeLocalisation() && Model.ContactEmpty()))
{
	<div class="localisationGeneralInfo contentBlock">
		<h3 class="blue">@Worki.Resources.Views.Home.HomeString.Contact</h3>
		@if (!Model.ContactEmpty())
  {
      if (!string.IsNullOrEmpty(Model.Mail))
      {
				@Html.Mailto(Model.Mail, Model.Mail, new { itemprop = "email" })<br />
      }
      if (!string.IsNullOrEmpty(Model.WebSite))
      {
				<a href="@WebHelper.GetWebsite(Model.WebSite)" title="@Model.WebSite" target="_blank" itemprop="url">@Worki.Resources.Models.Localisation.Localisation.WebSite</a><br />
      }
      if (!string.IsNullOrEmpty(Model.PhoneNumber))
      {
				<span class="bold">@Worki.Resources.Views.Localisation.LocalisationString.Tel</span>
				<span itemprop="telephone">@Html.GetPhoneFormat(Model.PhoneNumber)</span><br />
      }
      if (!string.IsNullOrEmpty(Model.Fax))
      {
				<span class="bold">@Worki.Resources.Views.Localisation.LocalisationString.Fax</span>
				<span itemprop="faxNumber">@Html.GetPhoneFormat(Model.Fax)</span><br />
      }
      if (!string.IsNullOrEmpty(Model.Facebook))
      {
				<a href="@WebHelper.GetWebsite(Model.Facebook)" target="_blank"><span>@Worki.Resources.Views.Localisation.LocalisationString.FacebookPage</span></a><br />
      }
      if (!string.IsNullOrEmpty(Model.Twitter))
      {
				<a href="@WebHelper.GetTwitter(Model.Twitter)" target="_blank"><span>@WebHelper.GetLoginTwitter(Model.Twitter)</span></a><br />
      }
      if (!Model.HasOwner())
      {
				@Html.ActionLink(Worki.Resources.Views.Localisation.LocalisationString.AreYouOwner, MVC.Localisation.SetOwnership(Model.ID))
      }
  }
  else
  {
			<span>@Worki.Resources.Views.Localisation.LocalisationString.YouKnowContactUs</span>
  }
	</div>
}
<div class="localisationSchedule contentBlock">
	<h3 class="blue">@Worki.Resources.Views.Localisation.LocalisationString.Schedule</h3>
	@if (Model.HasFeature(Feature.Access24))
 {
		@Html.FeatureLabelFor(Feature.Access24, Model)
 }
 else if (Model.HasOpenningTimes())
 {
	<table>
		@RazorHelpers.OpenningRow(Model, DayOfWeek.Monday, Worki.Resources.Views.Localisation.LocalisationFormString.Monday)
		@RazorHelpers.OpenningRow(Model, DayOfWeek.Tuesday, Worki.Resources.Views.Localisation.LocalisationFormString.Tuesday)
		@RazorHelpers.OpenningRow(Model, DayOfWeek.Wednesday, Worki.Resources.Views.Localisation.LocalisationFormString.Wednesday)
		@RazorHelpers.OpenningRow(Model, DayOfWeek.Thursday, Worki.Resources.Views.Localisation.LocalisationFormString.Thursday)
		@RazorHelpers.OpenningRow(Model, DayOfWeek.Friday, Worki.Resources.Views.Localisation.LocalisationFormString.Friday)
		@RazorHelpers.OpenningRow(Model, DayOfWeek.Saturday, Worki.Resources.Views.Localisation.LocalisationFormString.Saturday)
		@RazorHelpers.OpenningRow(Model, DayOfWeek.Sunday, Worki.Resources.Views.Localisation.LocalisationFormString.Sunday)
	</table>
 }
 else
 {
		@Worki.Resources.Views.Shared.SharedString.KnowHouly @MiscHelpers.EmailConstants.ContactMail
 }
</div>

<div class="contentBlock">
	<h3 class="blue marginb10">@Worki.Resources.Views.Localisation.LocalisationString.Suggestion</h3>
	@{Html.RenderAction(MVC.Localisation.Suggestions(Model.ID));}
</div>
