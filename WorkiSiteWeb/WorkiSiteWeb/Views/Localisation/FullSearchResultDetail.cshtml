@model Worki.Data.Models.SearchSingleResultViewModel

@section HeadContent
{
    @{
        var metaData = Model.Localisation.GetMetaData();
        metaData.Url = Model.Localisation.GetDetailFullUrl(Url);
        }
    @Html.Partial(MVC.Shared.Views._MetaDataHeader, metaData) 
    <link href="@Url.VersionedContent(Links.Content.Search_min_css)" rel="stylesheet" type="text/css" />
    <link href="@Url.VersionedContent(Links.Content.LocalisationDetail_min_css)" rel="stylesheet" type="text/css" />
    <link href="@Url.VersionedContent(Links.Content.rateit_min_css)" rel="stylesheet" type="text/css" />	
    <link href="@Url.VersionedContent(Links.Content.Profil_min_css)" rel="stylesheet" type="text/css"/>
    <link href="@Url.VersionedContent(Links.Content.colorbox_css)" rel="stylesheet" type="text/css"/>
}

@if (Model.FromSearch)
{ 
<div class="float-left blue">
    @{ 
		var rvd = WebHelper.GetRVD(this);
    }
    @Html.ActionLink(Worki.Resources.Views.Search.SearchString.ReturnToResult, MVC.Localisation.ActionNames.FullSearchResult, rvd)
</div>
<div class="float-right blue">
    @Html.PageDetailLinks(Model.Index, Model.TotalItems, x => { rvd["index"] = x; return Url.Action(MVC.Localisation.ActionNames.FullSearchResultDetail, rvd); }, Worki.Resources.Views.Shared.SharedString.PrevDesc, Worki.Resources.Views.Shared.SharedString.NextDesc, "inline-block")
</div>
<div class="clear">
</div>
}

@Html.Partial(MVC.Localisation.Views._LocalisationDetail, Model.Localisation)

@{
    if(TempData.ContainsKey(MiscHelpers.TempDataConstants.NewLocalisationId))
    {
        var id = (int)TempData[MiscHelpers.TempDataConstants.NewLocalisationId];
        <script type="text/javascript">
            require(["@Url.VersionedContent(Links.Scripts.jquery_colorbox_js)"], function () {
                $.colorbox({ href: '@Url.Action(MVC.Localisation.OpenGraphInvitation(id))', width: "580px" })
            });
        </script>
    }
}

@section ScriptContent
{
    <script type="text/javascript">
    	require(["@Url.VersionedContent(Links.Content.galleria.galleria_1_2_4_js)"], function () {
    		// Load the classic theme
    		Galleria.loadTheme('/Content/Galleria/galleria.classic.js');

    		// Initialize Galleria
    		$('.gallery').galleria({
    			//width: 600,
    			height: 350,
    			showInfo: false
    		});

    		$('.offerGallery').galleria({
    			width: 450,
    			height: 300,
    			showInfo: false
    		});
    	});
        require(["@Url.VersionedContent(Links.Scripts.jquery_rateit_js)"], function () {
            //rateit
            BindRateIt = function (name) {
                var rateItId = '#rateIt' + name;
                //var id = '#Comment_' + name;
                var id = '#' + name;
                $(rateItId).bind('rated', function (event, value) {
                    $(id).val(value);
                });
            }
            BindRateIt("Rating");
            BindRateIt("RatingPrice");
            BindRateIt("RatingWifi");
            BindRateIt("RatingDispo");
            BindRateIt("RatingWelcome");
        });

        var resetDashed = function () {
            var count = $('.blockContainer').size();
            if (count > 1) {
                $('.blockContainer').removeClass('dashedRight');
                $('.blockContainer').removeClass('dashedLeft');
                var firstHeight = $('.blockContainer').first().height();
                var lastHeight = $('.blockContainer').last().height();
                if (firstHeight > lastHeight) {
                    $('.blockContainer').first().addClass('dashedRight');
                }
                else {
                    $('.blockContainer').last().addClass('dashedLeft');
                }
            }
        }; 
 
        require(["@Url.VersionedContent(Links.Scripts.tabs_js)"], function () {
            InitTab(".detailTabs", ".detailTab", null, resetDashed);
            InitTab(".offerTabs", ".offerTab", ".offerTab_content", resetDashed);
            InitTab(".communityTabs", ".communityTab", ".communityTab_content", resetDashed);
        });

        $('#bookItNow').click(function () {
            $('#offerTabLink').click();
        });

        require(["https://apis.google.com/js/plusone.js"], function () {
            { lang: '@Url.GetCulture().ToString()' }
        });
    </script>
	@Html.Partial(MVC.Localisation.Views._CommentFormScript, Model.Localisation)
}
