function WorkiMapSearch(u,t,q,r,x,v,w,p){var g=u;var f=t;var b=q;var c=r;var k=x;var h=v==null?true:v;var i=w==null?true:w;var a=p==null?true:p;var l=null;var o=null;var e=null;var j=false;var n=true;var d=window.History;var m=d.getRootUrl();d.Adapter.bind(window,"statechange",function(){var z=d.getState(),A=z.url,y=A.replace(m,"");if(n==false){n=true;return}$.ajax({url:A,cache:false,success:k})});_bounds_changed=function(){var y=this.getBounds();var z=y.getNorthEast().lat();var A=y.getNorthEast().lng();var B=y.getSouthWest().lat();var C=y.getSouthWest().lng();$("#Criteria_NorthEastLat").val(z);$("#Criteria_NorthEastLng").val(A);$("#Criteria_SouthWestLat").val(B);$("#Criteria_SouthWestLng").val(C);if(!j){$("#searchFormReset form").submit()}};_markerDetailPopUp=function(){var y=this.map;var z=this;$.ajax({url:g,data:{id:this.get("id")},success:function(A){if(e){e.close()}e=new google.maps.InfoWindow({content:A});e.open(y,z);$("div.rateit").rateit()}})};_markerDetailPage=function(){var y=this.map;var z=this;$.ajax({url:f,data:{id:this.get("id")},success:function(A){window.location.href=A}})};_askForResults=function(){j=false};_goToTop=function(){$("html, body").animate({scrollTop:0},0)};_pushResults=function(B,C){var y=new google.maps.LatLngBounds();this.Map.ClearMap();if(!c){this.Map.CenterSearchResults(B)}for(var z in C){var A=c?_markerDetailPopUp:_markerDetailPage;this.Map.AddMarker(C[z].latitude,C[z].longitude,C[z].name,C[z].id,y,A)}if(C.length>=2&&!c){this.Map.FitBoundsSearchResults(y)}if(c){this.Map.SetCluster()}j=true};_applyResults=function(y){_goToTop.apply();d.pushState(null,"",y.href);return false};var s=new ErrorBuilder("searchFormReset","searchFormError");_onSubmitSuccess=function(y){k(y);n=false;d.pushState(null,"",y.url)};_submitData=function(){_goToTop.apply();AppAjax(b,"POST",$("#searchFormReset form").serializeArray(),_onSubmitSuccess,s.ErrorFunc)};this.Map=l;this.WorkiGeoCoder=o;this.IsBig=c;this.Bounds_changed=_bounds_changed;this.AskForResults=_askForResults;this.ApplyResults=_applyResults;this.SubmitData=_submitData;this.PushResults=_pushResults;this.NeedAutocomplete=h;this.NeedMap=i;this.AjaxSubmit=a;this.MarkerHandler=this.IsBig?_markerDetailPopUp:_markerDetailPage};