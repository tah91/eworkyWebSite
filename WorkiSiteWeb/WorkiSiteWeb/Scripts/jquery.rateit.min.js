(function(a){a.fn.rateit=function(f,g){var e={};var d="init";var c=function(i){return i.charAt(0).toUpperCase()+i.substr(1)};if(this.length==0){return this}var h=a.type(f);if(h=="object"||f===undefined||f==null){e=a.extend({},a.fn.rateit.defaults,f)}else{if(h=="string"&&g===undefined){return this.data("rateit"+c(f))}else{if(h=="string"){d="setvalue"}}}return this.each(function(){var k=a(this);var l=function(r,s){return k.data("rateit"+c(r),s)};if(!k.hasClass("rateit")){k.addClass("rateit")}var m=k.css("direction")!="rtl";if(d=="setvalue"){if(!l("init")){throw"Can't set value before init"}if(f=="readonly"&&!l("readonly")){k.find(".rateit-range").unbind();l("wired",false)}if(l("backingfld")){var j=a(l("backingfld"));if(f=="value"){j.val(g)}if(f=="min"&&j[0].min){j[0].min=g}if(f=="max"&&j[0].max){j[0].max=g}if(f=="step"&&j[0].step){j[0].step=g}}l(f,g)}if(!l("init")){l("min",l("min")||e.min);l("max",l("max")||e.max);l("step",l("step")||e.step);l("readonly",l("readonly")!==undefined?l("readonly"):e.readonly);l("resetable",l("resetable")!==undefined?l("resetable"):e.resetable);l("backingfld",l("backingfld")||e.backingfld);l("starwidth",l("starwidth")||e.starwidth);l("starheight",l("starheight")||e.starheight);l("value",l("value")||e.min);l("ispreset",l("ispreset")!==undefined?l("ispreset"):e.ispreset);if(l("backingfld")){var j=a(l("backingfld"));l("value",j.hide().val());if(j[0].nodeName=="INPUT"){if(j[0].type=="range"||j[0].type=="text"){l("min",parseInt(j.attr("min"))||l("min"));l("max",parseInt(j.attr("max"))||l("max"));l("step",parseInt(j.attr("step"))||l("step"))}}if(j[0].nodeName=="SELECT"&&j[0].options.length>1){l("min",Number(j[0].options[0].value));l("max",Number(j[0].options[j[0].length-1].value));l("step",Number(j[0].options[1].value)-Number(j[0].options[0].value))}}k.append('<div class="rateit-reset"></div><div class="rateit-range"><div class="rateit-selected" style="height:'+l("starheight")+'px"></div><div class="rateit-hover" style="height:'+l("starheight")+'px"></div></div>');if(!m){k.find(".rateit-reset").css("float","right");k.find(".rateit-selected").addClass("rateit-selected-rtl");k.find(".rateit-hover").addClass("rateit-hover-rtl")}l("init",true)}var o=k.find(".rateit-range");o.width(l("starwidth")*(l("max")-l("min"))).height(l("starheight"));var n="rateit-preset"+((m)?"":"-rtl");if(l("ispreset")){k.find(".rateit-selected").addClass(n)}else{k.find(".rateit-selected").removeClass(n)}if(l("value")){var q=(l("value")-l("min"))*l("starwidth");k.find(".rateit-selected").width(q)}var p=k.find(".rateit-reset");var i=function(r,s){var u=(s.changedTouches)?s.changedTouches[0].pageX:s.pageX;var t=u-a(r).offset().left;if(!m){t=o.width()-t}if(t>o.width()){t=o.width()}if(t<0){t=0}return q=Math.ceil(t/l("starwidth")*(1/l("step")))};if(!l("readonly")){if(l("resetable")){p.click(function(){l("value",l("min"));o.find(".rateit-hover").hide().width(0);o.find(".rateit-selected").width(0).show();if(l("backingfld")){a(l("backingfld")).val(l("min"))}k.trigger("reset")})}else{p.hide()}if(!l("wired")){o.bind("touchmove touchend",b);o.mousemove(function(r){var t=i(this,r);var u=t*l("starwidth")*l("step");var s=o.find(".rateit-hover");if(s.data("width")!=u){o.find(".rateit-selected").hide();s.width(u).show().data("width",u);k.trigger("hover",[(t*l("step"))+l("min")])}});o.mouseleave(function(r){o.find(".rateit-hover").hide().width(0).data("width","");k.trigger("hover",[null]);o.find(".rateit-selected").show()});o.mouseup(function(r){var t=i(this,r);var s=(t*l("step"))+l("min");l("value",s);if(l("backingfld")){a(l("backingfld")).val(s)}if(l("ispreset")){o.find(".rateit-selected").removeClass(n);l("ispreset",false)}o.find(".rateit-hover").hide();o.find(".rateit-selected").width(t*l("starwidth")*l("step")).show();k.trigger("hover",[null]).trigger("rated",[s])});l("wired",true)}if(l("resetable")){p.show()}}else{p.hide()}})};function b(c){var f=c.originalEvent.changedTouches,d=f[0],g="";switch(c.type){case"touchmove":g="mousemove";break;case"touchend":g="mouseup";break;default:return}var e=document.createEvent("MouseEvent");e.initMouseEvent(g,true,true,window,1,d.screenX,d.screenY,d.clientX,d.clientY,false,false,false,false,0,null);d.target.dispatchEvent(e);c.preventDefault()}a.fn.rateit.defaults={min:0,max:5,step:0.5,starwidth:16,starheight:16,readonly:false,resetable:true,ispreset:false};a("div.rateit").rateit()})(jQuery);