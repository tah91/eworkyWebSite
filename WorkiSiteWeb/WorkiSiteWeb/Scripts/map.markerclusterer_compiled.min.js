(function(){var c=null;function f(d){return function(e){this[d]=e}}function g(d){return function(){return this[d]}}var i;function m(d,e,h){this.extend(m,google.maps.OverlayView);this.c=d;this.a=[];this.f=[];this.ca=[53,56,66,78,90];this.j=[];this.A=!1;h=h||{};this.g=h.gridSize||60;this.l=h.minimumClusterSize||2;this.J=h.maxZoom||c;this.j=h.styles||[];this.X=h.imagePath||this.Q;this.W=h.imageExtension||this.P;this.O=!0;if(h.zoomOnClick!=void 0){this.O=h.zoomOnClick}this.r=!1;if(h.averageCenter!=void 0){this.r=h.averageCenter}o(this);this.setMap(d);this.K=this.c.getZoom();var j=this;google.maps.event.addListener(this.c,"zoom_changed",function(){var k=j.c.getZoom();if(j.K!=k){j.K=k,j.m()}});google.maps.event.addListener(this.c,"idle",function(){j.i()});e&&e.length&&this.C(e,!1)}i=m.prototype;i.Q="http://google-maps-utility-library-v3.googlecode.com/svn/trunk/markerclusterer/images/m";i.P="png";i.extend=function(d,e){return function(h){for(var j in h.prototype){this.prototype[j]=h.prototype[j]}return this}.apply(d,[e])};i.onAdd=function(){if(!this.A){this.A=!0,p(this)}};i.draw=function(){};function o(d){if(!d.j.length){for(var e=0,h;h=d.ca[e];e++){d.j.push({url:d.X+(e+1)+"."+d.W,height:h,width:h})}}}i.S=function(){for(var d=this.o(),e=new google.maps.LatLngBounds,h=0,j;j=d[h];h++){e.extend(j.getPosition())}this.c.fitBounds(e)};i.z=g("j");i.o=g("a");i.V=function(){return this.a.length};i.ba=f("J");i.I=g("J");i.G=function(d,e){for(var h=0,j=d.length,k=j;k!==0;){k=parseInt(k/10,10),h++}h=Math.min(h,e);return{text:j,index:h}};i.$=f("G");i.H=g("G");i.C=function(d,e){for(var h=0,j;j=d[h];h++){u(this,j)}e||this.i()};function u(d,e){e.s=!1;e.draggable&&google.maps.event.addListener(e,"dragend",function(){e.s=!1;d.L()});d.a.push(e)}i.q=function(d,e){u(this,d);e||this.i()};function v(d,e){var h=-1;if(d.a.indexOf){h=d.a.indexOf(e)}else{for(var j=0,k;k=d.a[j];j++){if(k==e){h=j;break}}}if(h==-1){return !1}e.setMap(c);d.a.splice(h,1);return !0}i.Y=function(d,e){var h=v(this,d);return !e&&h?(this.m(),this.i(),!0):!1};i.Z=function(d,e){for(var h=!1,j=0,k;k=d[j];j++){k=v(this,k),h=h||k}if(!e&&h){return this.m(),this.i(),!0}};i.U=function(){return this.f.length};i.getMap=g("c");i.setMap=f("c");i.w=g("g");i.aa=f("g");i.v=function(d){var e=this.getProjection(),h=new google.maps.LatLng(d.getNorthEast().lat(),d.getNorthEast().lng()),j=new google.maps.LatLng(d.getSouthWest().lat(),d.getSouthWest().lng()),h=e.fromLatLngToDivPixel(h);h.x+=this.g;h.y-=this.g;j=e.fromLatLngToDivPixel(j);j.x-=this.g;j.y+=this.g;h=e.fromDivPixelToLatLng(h);e=e.fromDivPixelToLatLng(j);d.extend(h);d.extend(e);return d};i.R=function(){this.m(!0);this.a=[]};i.m=function(d){for(var e=0,h;h=this.f[e];e++){h.remove()}for(e=0;h=this.a[e];e++){h.s=!1,d&&h.setMap(c)}this.f=[]};i.L=function(){var d=this.f.slice();this.f.length=0;this.m();this.i();window.setTimeout(function(){for(var e=0,h;h=d[e];e++){h.remove()}},0)};i.i=function(){p(this)};function p(d){if(d.A){for(var e=d.v(new google.maps.LatLngBounds(d.c.getBounds().getSouthWest(),d.c.getBounds().getNorthEast())),h=0,j;j=d.a[h];h++){if(!j.s&&e.contains(j.getPosition())){for(var k=d,s=40000,q=c,t=0,n=void 0;n=k.f[t];t++){var l=n.getCenter();if(l){var r=j.getPosition();if(!l||!r){l=0}else{var y=(r.lat()-l.lat())*Math.PI/180,z=(r.lng()-l.lng())*Math.PI/180,l=Math.sin(y/2)*Math.sin(y/2)+Math.cos(l.lat()*Math.PI/180)*Math.cos(r.lat()*Math.PI/180)*Math.sin(z/2)*Math.sin(z/2),l=6371*2*Math.atan2(Math.sqrt(l),Math.sqrt(1-l))}l<s&&(s=l,q=n)}}q&&q.F.contains(j.getPosition())?q.q(j):(n=new w(k),n.q(j),k.f.push(n))}}}}function w(d){this.k=d;this.c=d.getMap();this.g=d.w();this.l=d.l;this.r=d.r;this.d=c;this.a=[];this.F=c;this.n=new x(this,d.z(),d.w())}i=w.prototype;i.q=function(d){var e;d:if(this.a.indexOf){e=this.a.indexOf(d)!=-1}else{e=0;for(var h;h=this.a[e];e++){if(h==d){e=!0;break d}}e=!1}if(e){return !1}if(this.d){if(this.r){h=this.a.length+1,e=(this.d.lat()*(h-1)+d.getPosition().lat())/h,h=(this.d.lng()*(h-1)+d.getPosition().lng())/h,this.d=new google.maps.LatLng(e,h),C(this)}}else{this.d=d.getPosition(),C(this)}d.s=!0;this.a.push(d);e=this.a.length;e<this.l&&d.getMap()!=this.c&&d.setMap(this.c);if(e==this.l){for(h=0;h<e;h++){this.a[h].setMap(c)}}e>=this.l&&d.setMap(c);d=this.c.getZoom();if((e=this.k.I())&&d>e){for(d=0;e=this.a[d];d++){e.setMap(this.c)}}else{if(this.a.length<this.l){D(this.n)}else{e=this.k.H()(this.a,this.k.z().length);this.n.setCenter(this.d);d=this.n;d.B=e;d.ga=e.text;d.ea=e.index;if(d.b){d.b.innerHTML=e.text}e=Math.max(0,d.B.index-1);e=Math.min(d.j.length-1,e);e=d.j[e];d.da=e.url;d.h=e.height;d.p=e.width;d.M=e.textColor;d.e=e.anchor;d.N=e.textSize;d.D=e.backgroundPosition;this.n.show()}}return !0};i.getBounds=function(){for(var d=new google.maps.LatLngBounds(this.d,this.d),e=this.o(),h=0,j;j=e[h];h++){d.extend(j.getPosition())}return d};i.remove=function(){this.n.remove();this.a.length=0;delete this.a};i.T=function(){return this.a.length};i.o=g("a");i.getCenter=g("d");function C(d){d.F=d.k.v(new google.maps.LatLngBounds(d.d,d.d))}i.getMap=g("c");function x(d,e,h){d.k.extend(x,google.maps.OverlayView);this.j=e;this.fa=h||0;this.u=d;this.d=c;this.c=d.getMap();this.B=this.b=c;this.t=!1;this.setMap(this.c)}i=x.prototype;i.onAdd=function(){this.b=document.createElement("DIV");if(this.t){this.b.style.cssText=a(this,b(this,this.d)),this.b.innerHTML=this.B.text}this.getPanes().overlayMouseTarget.appendChild(this.b);var d=this;google.maps.event.addDomListener(this.b,"click",function(){var e=d.u.k;google.maps.event.trigger(e,"clusterclick",d.u);e.O&&d.c.fitBounds(d.u.getBounds())})};function b(d,e){var h=d.getProjection().fromLatLngToDivPixel(e);h.x-=parseInt(d.p/2,10);h.y-=parseInt(d.h/2,10);return h}i.draw=function(){if(this.t){var d=b(this,this.d);this.b.style.top=d.y+"px";this.b.style.left=d.x+"px"}};function D(d){if(d.b){d.b.style.display="none"}d.t=!1}i.show=function(){if(this.b){this.b.style.cssText=a(this,b(this,this.d)),this.b.style.display=""}this.t=!0};i.remove=function(){this.setMap(c)};i.onRemove=function(){if(this.b&&this.b.parentNode){D(this),this.b.parentNode.removeChild(this.b),this.b=c}};i.setCenter=f("d");function a(d,e){var h=[];h.push("background-image:url("+d.da+");");h.push("background-position:"+(d.D?d.D:"0 0")+";");typeof d.e==="object"?(typeof d.e[0]==="number"&&d.e[0]>0&&d.e[0]<d.h?h.push("height:"+(d.h-d.e[0])+"px; padding-top:"+d.e[0]+"px;"):h.push("height:"+d.h+"px; line-height:"+d.h+"px;"),typeof d.e[1]==="number"&&d.e[1]>0&&d.e[1]<d.p?h.push("width:"+(d.p-d.e[1])+"px; padding-left:"+d.e[1]+"px;"):h.push("width:"+d.p+"px; text-align:center;")):h.push("height:"+d.h+"px; line-height:"+d.h+"px; width:"+d.p+"px; text-align:center;");h.push("cursor:pointer; top:"+e.y+"px; left:"+e.x+"px; color:"+(d.M?d.M:"black")+"; position:absolute; font-size:"+(d.N?d.N:11)+"px; font-family:Arial,sans-serif; font-weight:bold");return h.join("")}window.MarkerClusterer=m;m.prototype.addMarker=m.prototype.q;m.prototype.addMarkers=m.prototype.C;m.prototype.clearMarkers=m.prototype.R;m.prototype.fitMapToMarkers=m.prototype.S;m.prototype.getCalculator=m.prototype.H;m.prototype.getGridSize=m.prototype.w;m.prototype.getExtendedBounds=m.prototype.v;m.prototype.getMap=m.prototype.getMap;m.prototype.getMarkers=m.prototype.o;m.prototype.getMaxZoom=m.prototype.I;m.prototype.getStyles=m.prototype.z;m.prototype.getTotalClusters=m.prototype.U;m.prototype.getTotalMarkers=m.prototype.V;m.prototype.redraw=m.prototype.i;m.prototype.removeMarker=m.prototype.Y;m.prototype.removeMarkers=m.prototype.Z;m.prototype.resetViewport=m.prototype.m;m.prototype.repaint=m.prototype.L;m.prototype.setCalculator=m.prototype.$;m.prototype.setGridSize=m.prototype.aa;m.prototype.setMaxZoom=m.prototype.ba;m.prototype.onAdd=m.prototype.onAdd;m.prototype.draw=m.prototype.draw;w.prototype.getCenter=w.prototype.getCenter;w.prototype.getSize=w.prototype.T;w.prototype.getMarkers=w.prototype.o;x.prototype.onAdd=x.prototype.onAdd;x.prototype.draw=x.prototype.draw;x.prototype.onRemove=x.prototype.onRemove})();