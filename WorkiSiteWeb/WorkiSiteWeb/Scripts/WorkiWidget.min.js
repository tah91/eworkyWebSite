var root="http://www.eworky.fr";var eworkyClass=function(){this.initialize.apply(this,arguments)};eworkyClass.prototype={initialize:function(){this.widgetDict={};this.iframeIntermediateDomain=root+"/widget/intermediate";this.iframeDomain=root+"/widget/intermediate/dispatch"},postInitialize:function(){this.initializeWidgets()},initializeWidgets:function(){var d=this.findWidgets();for(var a=0;a<d.length;a++){var c=d[a];var b=a+1;this.widgetDict[b]=new eworkyWidgetClass(c,b,this.iframeIntermediateDomain,this.iframeDomain)}},findWidgets:function(){var a=document.getElementsByTagName("div");var d="eworky-widget";var e=[];for(var c=0;c<a.length;c++){var b=a[c];if(b.className.indexOf(d)>=0){e.push(b)}}return e},listen:function(){return eworkyUtils.listen.apply(eworkyUtils,arguments)}};var eworkyUtilsClass=function(){this.initialize.apply(this,arguments)};eworkyUtilsClass.prototype={initialize:function(){this.eventMap={}},getUrlVars:function(e){var d={},b;e=e||window.location.href;var c=e.slice(e.indexOf("?")+1).split("&");for(var a=0;a<c.length;a++){b=c[a].split("=");d[b[0]]=decodeURIComponent(b[1])}return d},parseData:function(b){var e={};for(var c=0;c<b.attributes.length;c++){var a=b.attributes[c];if(a.name.indexOf("data-")==0){var d=a.name.replace("data-","");var f=a.value;e[d]=f}}return e},ready:function(){if(!eworkyUtils.isReady){if(!document.body){return setTimeout(eworkyUtils.ready,13)}eworkyUtils.isReady=true;try{eworky=new eworkyClass();if(typeof(eworkyAsyncLoaded)!="undefined"){eworkyAsyncLoaded()}eworky.postInitialize()}catch(a){if(typeof(console)!="undefined"){console.log(a)}}}},bindReady:function(){if(eworkyUtils.readyBound){return}eworkyUtils.readyBound=true;if(document.readyState==="complete"){return eworkyUtils.ready()}if(document.addEventListener){document.addEventListener("DOMContentLoaded",DOMContentLoaded,false);window.addEventListener("load",eworkyUtils.ready,false)}else{if(document.attachEvent){document.attachEvent("onreadystatechange",DOMContentLoaded);var b=false;try{b=window.frameElement==null}catch(a){}if(document.documentElement.doScroll&&b){doScrollCheck()}}}},listen:function(a,b){if(!(a in this.eventMap)){this.eventMap[a]=[]}this.eventMap[a].push(b)},fire:function(b){if(b in this.eventMap){var a=this.eventMap[b];for(var d=0;d<a.length;d++){var c=a[d];c.apply(c,arguments)}}}};eworkyUtils=new eworkyUtilsClass();var eworkyWidgetClass=function(){this.initialize.apply(this,arguments)};eworkyWidgetClass.prototype={initialize:function(b,c,d,a){this.element=b;this.data=eworkyUtils.parseData(this.element);this.widgetId=c;this.type=this.data.kind;this.iframeIntermediateDomain=d;this.iframeDomain=a;eworkyUtils.fire("pre_button_init",this.type,this.data,this);this.width=this.data.width;if(this.type=="finder"||this.type=="detail"){if(this.width<780){this.width=780}}this.baseFormat()},getIframeUrl:function(){var a=this.iframeIntermediateDomain+"?width="+this.width+"&id=eworky_widget_"+this.widgetId+"&name=eworky_widget_"+this.widgetId;var b=this.iframeDomain+this.getPopupQueryString();return a+"&url="+b},getPopupQueryString:function(){var b="";for(dataKey in this.data){var a=this.data[dataKey];if(a){b+="&"+dataKey+"="+encodeURIComponent(a)}}return b},baseFormat:function(){var b=this.width;var a=new easyXDM.Socket({remote:this.getIframeUrl(),container:this.element,onMessage:function(c,d){this.container.getElementsByTagName("iframe")[0].style.height=c+"px"},onReady:function(){this.container.getElementsByTagName("iframe")[0].style.width=b+"px"}})}};if(document.addEventListener){DOMContentLoaded=function(){document.removeEventListener("DOMContentLoaded",DOMContentLoaded,false);eworkyUtils.ready()}}else{if(document.attachEvent){DOMContentLoaded=function(){if(document.readyState==="complete"){document.detachEvent("onreadystatechange",DOMContentLoaded);eworkyUtils.ready()}}}}function doScrollCheck(){if(eworkyUtils.isReady){return}try{document.documentElement.doScroll("left")}catch(a){setTimeout(doScrollCheck,1);return}eworkyUtils.ready()}function loadScript(d,a){var b=document.getElementsByTagName("head")[0];var c=document.createElement("script");c.type="text/javascript";c.src=d;c.onreadystatechange=a;c.onload=a;b.appendChild(c)}var initializeFrames=function(){eworkyUtils.bindReady()};$.getScript(root+"/Scripts/easyXDM.js",function(){eworkyUtils.bindReady()});