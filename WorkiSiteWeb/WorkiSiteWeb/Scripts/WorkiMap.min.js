function Utils(){}Utils.GetCSharpDouble=function(b){var a=b.toString().replace(".",",");return a};Utils.GetJSDouble=function(b){var a=parseFloat(b.toString().replace(",","."));return a};function ReverseGeocoder(f,g,e){var c=f;var d=g;var a=e;var b=new google.maps.Geocoder();ReverseGeocodeAddress=function(){var h=jQuery.trim($(c).val());var k=jQuery.trim($(d).val());var j=new google.maps.LatLng(h,k);b.geocode({location:j,region:"FR"},_callbackForReverseGeocode)};_callbackForReverseGeocode=function(k,l){if(l==google.maps.GeocoderStatus.OK){var h=k[0].geometry.location.lat();var j=k[0].geometry.location.lng();$(c).val(h);$(d).val(j);$(a).val(k[0].formatted_address)}};this.ReverseGeocodeAddress=ReverseGeocodeAddress}function WorkiAutoComplete(c){var b=c;var a=new google.maps.Geocoder();SetAutocomplete=function(){$(b).autocomplete({minLength:5,source:function(g,h){if(a==null){a=new google.maps.Geocoder()}var d=new google.maps.LatLng(41.395378,-5.93291);var k=new google.maps.LatLng(52.444311,11.381544);var j=new google.maps.LatLng(51.800574,-5.815127);var e=new google.maps.LatLng(40.737341,11.713035);var f=new google.maps.LatLngBounds(d,k);a.geocode({address:g.term+", fr",bounds:f,region:"FR"},function(l,m){if(m==google.maps.GeocoderStatus.OK){h($.map(l,function(q){var r=q.geometry.location;var n=q.geometry.location.lat();var p=q.geometry.location.lng();var o=new google.maps.LatLng(n,p);if(!f.contains(o)){return}return{label:q.formatted_address,value:q.formatted_address}}))}})},select:function(d,g){var f=g.item.position;var e=g.item.locType}})};this.SetAutocomplete=SetAutocomplete}function WorkiGeocoder(l,m,j,k,n){var f=l;var g=m;var a=j;var b=k;var h=n;var d=new google.maps.Geocoder();var e=null;var c=null;SearchFormSubmit=function(p,q){c=q;_evt=p;_evt.preventDefault();$(c).unbind("submit");var o=jQuery.trim($(a).val());if(o.length<1){return}GeocodeAddress(o)};SearchHandler=function(p,q){p.preventDefault();var o=jQuery.trim($(a).val());if(o.length<1){return}e=q;GeocodeAddress(o)};GeocodeAddress=function(o){$(f).val("0");$(g).val("0");d.geocode({address:o,region:"FR"},_callbackForGeocode)};_callbackForGeocode=function(s,t){if(t==google.maps.GeocoderStatus.OK){var q=s[0].geometry.location.lat();var r=s[0].geometry.location.lng();$(f).val(q);$(g).val(r);if(h!=null){for(var o in s[0].address_components){var p=s[0].address_components[o];for(typeIndex in p.types){if(p.long_name==null){continue}else{if(p.types[typeIndex]=="postal_code"){$(h).val(p.long_name)}else{if(p.types[typeIndex]=="locality"){$(b).val(p.long_name)}}}}}}if(e!=null){e.call()}}if(c!=null){$(c).submit()}};this.SearchFormSubmit=SearchFormSubmit;this.GeocodeAddress=GeocodeAddress;this.SearchHandler=SearchHandler}function WorkiMap(m,k,l){var g=m;var j=null;var a=null;var h=[];var b=new google.maps.Geocoder();var e=k;var f=l;var c=null;var d=null;LoadSearchMap=function(p){var o={zoom:9,mapTypeControl:false,mapTypeId:google.maps.MapTypeId.ROADMAP};j=new google.maps.Map(document.getElementById(g),o);var n=new google.maps.LatLng(48,2);j.setCenter(n);d=p;CenterSearchResults(p);_SetResetControl();this.Map=j};SetCluster=function(){var n=new MarkerClusterer(j,h)};CenterSearchResults=function(n){b.geocode({address:n},_callbackForCenterSearchResults)};_callbackForCenterSearchResults=function(n,o){if(o==google.maps.GeocoderStatus.OK){j.setCenter(n[0].geometry.location);LoadPin(n[0].geometry.location,"Votre recherche",false,j,null,true)}};LoadDetailMap=function(p,q,s,o){var r={zoom:15,mapTypeControl:false,mapTypeId:google.maps.MapTypeId.ROADMAP};a=new google.maps.Map(document.getElementById(g),r);var n=new google.maps.LatLng(48,2);if(p!=null&&p!=0&&q!=null&&q!=0){n=new google.maps.LatLng(p,q)}else{a.setZoom(5)}a.setCenter(n);LoadPin(n,s,o,a);google.maps.event.trigger(a,"resize")};ClearMap=function(){if(h){for(i in h){h[i].setMap(null)}h.length=0}};_SetResetControl=function(){var n=document.createElement("DIV");n.index=1;n.style.padding="5px";var o=document.createElement("div");o.style.background="#5DAFDE url('/Content/images/geoloc.png') no-repeat center center";o.style.borderRadius="3px";o.style.cursor="pointer";o.style.width="20px";o.style.height="20px";o.title="Cliquer pour revenir à la position initial";n.appendChild(o);google.maps.event.addDomListener(o,"click",function(){CenterSearchResults(d);if(c!=null){FitBoundsSearchResults(c)}});j.controls[google.maps.ControlPosition.TOP_RIGHT].push(n)};LoadPin=function(r,t,p,u,n,o){if(p==null){p=false}if(u==null){u=j}var v='<span class="pinTitle"> '+t+"</span>";var q="/Content/images/iconeMap.png";if(o!=null){q="/Content/images/iconeMapRed.png"}var s=new google.maps.Marker({position:r,map:u,title:t,icon:q});h.push(s);s.setDraggable(p);if(p){google.maps.event.addListener(s,"dragend",function(){$(e).val(s.getPosition().lat());$(f).val(s.getPosition().lng())})}if(n!=null){google.maps.event.addListener(s,"click",n)}else{google.maps.event.addListener(s,"click",function(){})}};AddMarker=function(o,q,r,n){var p=new google.maps.LatLng(o,q);LoadPin(p,r);n.extend(p)};AddHandler=function(n,o){google.maps.event.addListener(j,n,o)};FitBoundsSearchResults=function(n){j.fitBounds(n);c=n};FindAddressOnMap=function(n){b.geocode({address:n},_callbackForFindAddressOnMap)};_callbackForFindAddressOnMap=function(n,o){if(o==google.maps.GeocoderStatus.OK){a.setCenter(n[0].geometry.location);a.setZoom(15);LoadPin(n[0].geometry.location,"Votre choix",true,a)}else{return}};this.LoadSearchMap=LoadSearchMap;this.SetCluster=SetCluster;this.LoadDetailMap=LoadDetailMap;this.ClearMap=ClearMap;this.CenterSearchResults=CenterSearchResults;this.LoadPin=LoadPin;this.AddMarker=AddMarker;this.FindAddressOnMap=FindAddressOnMap;this.FitBoundsSearchResults=FitBoundsSearchResults;this.AddHandler=AddHandler;this.Map=j};