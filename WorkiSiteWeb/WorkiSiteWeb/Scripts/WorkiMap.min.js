function Utils(){}Utils.GetCSharpDouble=function(b){var a=b.toString().replace(".",",");return a};Utils.GetJSDouble=function(b){var a=parseFloat(b.toString().replace(",","."));return a};function ReverseGeocoder(f,g,e){var c=f;var d=g;var a=e;var b=new google.maps.Geocoder();ReverseGeocodeAddress=function(){var h=jQuery.trim($(c).val());var k=jQuery.trim($(d).val());var j=new google.maps.LatLng(h,k);b.geocode({location:j,region:"FR"},_callbackForReverseGeocode)};_callbackForReverseGeocode=function(k,l){if(l==google.maps.GeocoderStatus.OK){var h=k[0].geometry.location.lat();var j=k[0].geometry.location.lng();$(c).val(h);$(d).val(j);$(a).val(k[0].formatted_address)}};this.ReverseGeocodeAddress=ReverseGeocodeAddress}function WorkiAutoComplete(c){var b=c;var a=new google.maps.Geocoder();SetAutocomplete=function(){$(b).autocomplete({minLength:5,source:function(g,h){if(a==null){a=new google.maps.Geocoder()}var d=new google.maps.LatLng(41.395378,-5.93291);var k=new google.maps.LatLng(52.444311,11.381544);var j=new google.maps.LatLng(51.800574,-5.815127);var e=new google.maps.LatLng(40.737341,11.713035);var f=new google.maps.LatLngBounds(d,k);a.geocode({address:g.term+", fr",bounds:f,region:"FR"},function(l,m){if(m==google.maps.GeocoderStatus.OK){h($.map(l,function(q){var r=q.geometry.location;var n=q.geometry.location.lat();var p=q.geometry.location.lng();var o=new google.maps.LatLng(n,p);if(!f.contains(o)){return}return{label:q.formatted_address,value:q.formatted_address}}))}})},select:function(d,g){var f=g.item.position;var e=g.item.locType}})};this.SetAutocomplete=SetAutocomplete}function WorkiGeocoder(l,m,j,k,n){var f=l;var g=m;var a=j;var b=k;var h=n;var d=new google.maps.Geocoder();var e=null;var c=null;SearchFormSubmit=function(p,q){c=q;_evt=p;_evt.preventDefault();$(c).unbind("submit");var o=jQuery.trim($(a).val());if(o.length<1){return}GeocodeAddress(o)};SearchHandler=function(p,q){p.preventDefault();var o=jQuery.trim($(a).val());if(o.length<1){return}e=q;GeocodeAddress(o)};GeocodeAddress=function(o){$(f).val("0");$(g).val("0");d.geocode({address:o,region:"FR"},_callbackForGeocode)};_callbackForGeocode=function(s,t){if(t==google.maps.GeocoderStatus.OK){var q=s[0].geometry.location.lat();var r=s[0].geometry.location.lng();$(f).val(q);$(g).val(r);if(h!=null){for(var o in s[0].address_components){var p=s[0].address_components[o];for(typeIndex in p.types){if(p.long_name==null){continue}else{if(p.types[typeIndex]=="postal_code"){$(h).val(p.long_name)}else{if(p.types[typeIndex]=="locality"){$(b).val(p.long_name)}}}}}}if(e!=null){e.call()}}if(c!=null){$(c).submit()}};this.SearchFormSubmit=SearchFormSubmit;this.GeocodeAddress=GeocodeAddress;this.SearchHandler=SearchHandler}function WorkiMap(q,o,p){var g=q;var n=null;var a=null;var m=[];var b=new google.maps.Geocoder();var h=null;var e=o;var f=p;var c=null;var d=null;var j="/Content/images/iconeMap.png";var l="/Content/images/iconeMapRed.png";var k="/Content/images/iconeMapOrange.png";LoadSearchMap=function(u,t){var s={scrollwheel:false,zoom:13,mapTypeControl:false,mapTypeId:google.maps.MapTypeId.ROADMAP};n=new google.maps.Map(document.getElementById(g),s);var r=new google.maps.LatLng(48,2);n.setCenter(r);d=u;CenterSearchResults(u);if(t){_SetResetControl()}this.Map=n};SetCluster=function(){var s=[{url:"/Content/images/circle.png",height:25,width:25,textColor:"white",textSize:10},{url:"/Content/images/circleBig.png",height:35,width:35,textColor:"white",textSize:12}];var r={gridSize:40,maxZoom:13,styles:s};h=new MarkerClusterer(n,m,r)};CenterSearchResults=function(r){b.geocode({address:r},_callbackForCenterSearchResults)};_callbackForCenterSearchResults=function(r,s){if(s==google.maps.GeocoderStatus.OK){n.setCenter(r[0].geometry.location);LoadPin(r[0].geometry.location,"Votre recherche",0,false,n,null,true)}};LoadDetailMap=function(t,u,w,s){var v={zoom:15,mapTypeControl:false,mapTypeId:google.maps.MapTypeId.ROADMAP};a=new google.maps.Map(document.getElementById(g),v);var r=new google.maps.LatLng(48,2);if(t!=null&&t!=0&&u!=null&&u!=0){r=new google.maps.LatLng(t,u)}else{a.setZoom(5)}a.setCenter(r);LoadPin(r,w,0,s,a);google.maps.event.trigger(a,"resize")};ClearMap=function(){if(m){for(i in m){m[i].setMap(null)}m.length=0}if(h){h.clearMarkers()}};_SetResetControl=function(){var r=document.createElement("DIV");r.index=1;r.style.padding="5px";var s=document.createElement("div");s.style.background="#5DAFDE url('/Content/images/geoloc.png') no-repeat center center";s.style.borderRadius="3px";s.style.cursor="pointer";s.style.width="20px";s.style.height="20px";s.title="Cliquer pour revenir à la position initial";r.appendChild(s);google.maps.event.addDomListener(s,"click",function(){CenterSearchResults(d);if(c!=null){FitBoundsSearchResults(c)}});n.controls[google.maps.ControlPosition.TOP_RIGHT].push(r)};LoadPin=function(w,y,u,t,z,r,s){if(t==null){t=false}if(z==null){z=n}var v=j;if(s!=null){v=l}var x=new google.maps.Marker({position:w,map:z,title:y,icon:v});x.set("id",u);m.push(x);x.setDraggable(t);if(t){google.maps.event.addListener(x,"dragend",function(){$(e).val(x.getPosition().lat());$(f).val(x.getPosition().lng())})}if(r!=null){google.maps.event.addListener(x,"click",r)}else{google.maps.event.addListener(x,"click",function(){})}google.maps.event.addListener(x,"mouseover",function(){x.setIcon(k)});google.maps.event.addListener(x,"mouseout",function(){x.setIcon(j)})};AddMarker=function(u,w,x,t,r,s){var v=new google.maps.LatLng(u,w);LoadPin(v,x,t,null,null,s);r.extend(v)};AddHandler=function(r,s){google.maps.event.addListener(n,r,s)};FitBoundsSearchResults=function(r){n.fitBounds(r);c=r};FindAddressOnMap=function(r){b.geocode({address:r},_callbackForFindAddressOnMap)};_callbackForFindAddressOnMap=function(r,s){if(s==google.maps.GeocoderStatus.OK){a.setCenter(r[0].geometry.location);a.setZoom(15);LoadPin(r[0].geometry.location,"Votre choix",0,true,a)}else{return}};this.LoadSearchMap=LoadSearchMap;this.SetCluster=SetCluster;this.LoadDetailMap=LoadDetailMap;this.ClearMap=ClearMap;this.CenterSearchResults=CenterSearchResults;this.LoadPin=LoadPin;this.AddMarker=AddMarker;this.FindAddressOnMap=FindAddressOnMap;this.FitBoundsSearchResults=FitBoundsSearchResults;this.AddHandler=AddHandler;this.Map=n};