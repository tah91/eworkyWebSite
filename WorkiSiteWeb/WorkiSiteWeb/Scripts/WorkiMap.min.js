function Utils(){}Utils.GetCSharpDouble=function(b){var a=b.toString().replace(".",",");return a};Utils.GetJSDouble=function(b){var a=parseFloat(b.toString().replace(",","."));return a};function ReverseGeocoder(h,j,f,g){var d=h;var e=j;var a=f;var b=new google.maps.Geocoder();var c=g;ReverseGeocodeAddress=function(){var k=jQuery.trim($(d).val());var m=jQuery.trim($(e).val());var l=new google.maps.LatLng(k,m);if(c=="fr"){b.geocode({location:l,region:"FR"},_callbackForReverseGeocode)}};_callbackForReverseGeocode=function(m,n){if(n==google.maps.GeocoderStatus.OK){var k=m[0].geometry.location.lat();var l=m[0].geometry.location.lng();$(d).val(k);$(e).val(l);$(a).val(m[0].formatted_address)}};this.ReverseGeocodeAddress=ReverseGeocodeAddress}function WorkiAutoComplete(e,d){var c=e;var a=new google.maps.Geocoder();var b=d;SetAutocomplete=function(){$(c).autocomplete({minLength:5,source:function(j,k){if(a==null){a=new google.maps.Geocoder()}if(b=="fr"){var f=new google.maps.LatLng(41.395378,-5.93291);var m=new google.maps.LatLng(52.444311,11.381544);var l=new google.maps.LatLng(51.800574,-5.815127);var g=new google.maps.LatLng(40.737341,11.713035);var h=new google.maps.LatLngBounds(f,m);a.geocode({address:j.term+", fr",bounds:h,region:"FR"},function(n,o){if(o==google.maps.GeocoderStatus.OK){k($.map(n,function(s){var t=s.geometry.location;var p=s.geometry.location.lat();var r=s.geometry.location.lng();var q=new google.maps.LatLng(p,r);if(!h.contains(q)){return}return{label:s.formatted_address,value:s.formatted_address}}))}})}},select:function(f,j){var h=j.item.position;var g=j.item.locType}})};this.SetAutocomplete=SetAutocomplete}function WorkiGeocoder(s,t,m,q,p,n,u,o,r){var j=s;var k=t;var a=m;var c=n;var l=u;var d=o;var f=q;var e=p;var g=new google.maps.Geocoder();var b=null;var h=r;SearchFormSubmit=function(w){w.preventDefault();$(f).unbind("submit");var v=jQuery.trim($(a).val());if(v.length<1){return}GeocodeAddress(v)};GeocodeAddress=function(v,w){$(j).val("0");$(k).val("0");b=w;if(h=="fr"){g.geocode({address:v,region:"FR"},_callbackForGeocode)}};_callbackForGeocode=function(z,A){if(A==google.maps.GeocoderStatus.OK){var x=z[0].geometry.location.lat();var y=z[0].geometry.location.lng();$(j).val(x);$(k).val(y);if(d!=null||l!=null){for(var v in z[0].address_components){var w=z[0].address_components[v];for(typeIndex in w.types){if(w.long_name==null){continue}if(w.types[typeIndex]=="country"){$(d).val(w.long_name)}else{if(w.types[typeIndex]=="postal_code"){$(l).val(w.long_name)}else{if(w.types[typeIndex]=="locality"){$(c).val(w.long_name)}}}}}}if(b!=null){b.call(null,x,y)}}if(q!=null){$(q).trigger("submit")}};this.SearchFormSubmit=SearchFormSubmit;this.GeocodeAddress=GeocodeAddress}function WorkiMap(m,k,l){var g=m;var j=null;var a=null;var h=[];var b=new google.maps.Geocoder();var e=k;var f=l;var c=null;var d=null;LoadSearchMap=function(p){var o={zoom:9,mapTypeControl:false,mapTypeId:google.maps.MapTypeId.ROADMAP};j=new google.maps.Map(document.getElementById(g),o);var n=new google.maps.LatLng(48,2);j.setCenter(n);d=p;_CenterSearchResults(p);_SetResetControl()};_CenterSearchResults=function(n){b.geocode({address:n},_callbackForCenterSearchResults)};_callbackForCenterSearchResults=function(n,o){if(o==google.maps.GeocoderStatus.OK){j.setCenter(n[0].geometry.location);LoadPin(n[0].geometry.location,"Votre recherche",false,j,null,true)}else{return}};LoadDetailMap=function(p,q,s,o){var r={zoom:15,mapTypeControl:false,mapTypeId:google.maps.MapTypeId.ROADMAP};a=new google.maps.Map(document.getElementById(g),r);var n=new google.maps.LatLng(48,2);if(p!=null&&p!=0&&q!=null&&q!=0){n=new google.maps.LatLng(p,q)}else{a.setZoom(5)}a.setCenter(n);LoadPin(n,s,o,a)};ClearMap=function(){if(h){for(i in h){h[i].setMap(null)}h.length=0}};_SetResetControl=function(){var n=document.createElement("DIV");n.index=1;n.style.padding="5px";var o=document.createElement("div");o.style.background="#5DAFDE url('/Content/images/geoloc.png') no-repeat center center";o.style.borderRadius="3px";o.style.cursor="pointer";o.style.width="20px";o.style.height="20px";o.title="Cliquer pour revenir à la position initial";n.appendChild(o);google.maps.event.addDomListener(o,"click",function(){_CenterSearchResults(d);if(c!=null){FitBoundsSearchResults(c)}});j.controls[google.maps.ControlPosition.TOP_RIGHT].push(n)};LoadPin=function(r,t,p,u,n,o){if(p==null){p=false}if(u==null){u=j}var v='<span class="pinTitle"> '+t+"</span>";var q="/Content/images/iconeMap.png";if(o!=null){q="/Content/images/iconeMapRed.png"}var s=new google.maps.Marker({position:r,map:u,title:t,icon:q});if(p==true){h.push(s)}s.setDraggable(p);if(p){google.maps.event.addListener(s,"dragend",function(){$(e).val(s.getPosition().lat());$(f).val(s.getPosition().lng())})}if(n!=null){google.maps.event.addListener(s,"click",n)}};FitBoundsSearchResults=function(n){j.fitBounds(n);c=n};FindAddressOnMap=function(n){b.geocode({address:n},_callbackForFindAddressOnMap)};_callbackForFindAddressOnMap=function(n,o){if(o==google.maps.GeocoderStatus.OK){a.setCenter(n[0].geometry.location);a.setZoom(15);LoadPin(n[0].geometry.location,"Votre choix",true,a)}else{return}};this.LoadSearchMap=LoadSearchMap;this.LoadDetailMap=LoadDetailMap;this.ClearMap=ClearMap;this.LoadPin=LoadPin;this.FindAddressOnMap=FindAddressOnMap;this.FitBoundsSearchResults=FitBoundsSearchResults};