function Utils(){}Utils.GetCSharpDouble=function(b){var a=b.toString().replace(".",",");return a};Utils.GetJSDouble=function(b){var a=parseFloat(b.toString().replace(",","."));return a};function WorkiAutoComplete(c){var b=c;var a=new google.maps.Geocoder();SetAutocomplete=function(){$(b).autocomplete({minLength:5,source:function(g,h){if(a==null){a=new google.maps.Geocoder()}var d=new google.maps.LatLng(41.395378,-5.93291);var k=new google.maps.LatLng(52.444311,11.381544);var j=new google.maps.LatLng(51.800574,-5.815127);var e=new google.maps.LatLng(40.737341,11.713035);var f=new google.maps.LatLngBounds(d,k);a.geocode({address:g.term+", fr",bounds:f,region:"FR"},function(l,m){if(m==google.maps.GeocoderStatus.OK){h($.map(l,function(q){var r=q.geometry.location;var n=q.geometry.location.lat();var p=q.geometry.location.lng();var o=new google.maps.LatLng(n,p);if(!f.contains(o)){return}return{label:q.formatted_address,value:q.formatted_address}}))}})},select:function(d,g){var f=g.item.position;var e=g.item.locType}})};this.SetAutocomplete=SetAutocomplete}function WorkiGeocoder(q,r,l,p,o,m,s,n){var h=q;var j=r;var a=l;var c=m;var k=s;var d=n;var f=p;var e=o;var g=new google.maps.Geocoder();var b=null;SearchFormSubmit=function(){e.preventDefault();$(f).unbind("submit");var t=jQuery.trim($(a).val());if(t.length<1){return}GeocodeAddress(t)};GeocodeAddress=function(t,u){$(h).val("0");$(j).val("0");b=u;g.geocode({address:t,region:"FR"},_callbackForGeocode)};_callbackForGeocode=function(x,y){if(y==google.maps.GeocoderStatus.OK){var v=x[0].geometry.location.lat();var w=x[0].geometry.location.lng();$(h).val(v);$(j).val(w);if(d!=null||k!=null){for(var t in x[0].address_components){var u=x[0].address_components[t];for(typeIndex in u.types){if(u.long_name==null){continue}if(u.types[typeIndex]=="country"){$(d).val(u.long_name)}else{if(u.types[typeIndex]=="postal_code"){$(k).val(u.long_name)}else{if(u.types[typeIndex]=="locality"){$(c).val(u.long_name)}}}}}}if(b!=null){b.call(null,v,w)}}if(p!=null){$(p).trigger("submit")}};this.SearchFormSubmit=SearchFormSubmit;this.GeocodeAddress=GeocodeAddress}function WorkiMap(k,h,j){var e=k;var g=null;var a=null;var f=[];var b=new google.maps.Geocoder();var c=h;var d=j;LoadSearchMap=function(){var m={zoom:9,mapTypeControl:false,mapTypeId:google.maps.MapTypeId.ROADMAP};g=new google.maps.Map(document.getElementById(e),m);var l=new google.maps.LatLng(48,2);g.setCenter(l)};LoadDetailMap=function(n,o,q,m){var p={zoom:15,mapTypeControl:false,mapTypeId:google.maps.MapTypeId.ROADMAP};a=new google.maps.Map(document.getElementById(e),p);var l=new google.maps.LatLng(48,2);if(n!=null&&n!=0&&o!=null&&o!=0){l=new google.maps.LatLng(n,o)}else{a.setZoom(5)}a.setCenter(l);LoadPin(l,q,m,a)};ClearMap=function(){if(f){for(i in f){f[i].setMap(null)}f.length=0}};LoadPin=function(n,p,l,q){if(l==null){l=false}if(q==null){q=g}var r='<span class="pinTitle"> '+p+"</span>";var m="/Content/images/iconeMap.png";var o=new google.maps.Marker({position:n,map:q,title:p,icon:m});if(l==true){f.push(o)}o.setDraggable(l);if(l){google.maps.event.addListener(o,"dragend",function(){$(c).val(o.getPosition().lat());$(d).val(o.getPosition().lng())})}};FitBoundsSearchResults=function(l){g.fitBounds(l)};CenterSearchResults=function(l){b.geocode({address:l},_callbackForCenterSearchResults)};_callbackForCenterSearchResults=function(l,m){if(m==google.maps.GeocoderStatus.OK){g.setCenter(l[0].geometry.location)}else{return}};FindAddressOnMap=function(l){b.geocode({address:l},_callbackForFindAddressOnMap)};_callbackForFindAddressOnMap=function(l,m){if(m==google.maps.GeocoderStatus.OK){a.setCenter(l[0].geometry.location);a.setZoom(15);LoadPin(l[0].geometry.location,"Votre choix",true,a)}else{return}};FindLocalisationsGivenLocation=function(l){b.geocode({address:l},_callbackUpdateMapLocalisations)};_callbackUpdateMapLocalisations=function(n,o){if(o==google.maps.GeocoderStatus.OK){var m=n[0].geometry.location;var l="/Search/FastSearch";$.post(l,{latitude:m.lat(),longitude:m.lng()},_renderLocalisations,"json")}else{return}};_renderLocalisations=function(n){$("#localisationList").empty();ClearMap();$.each(n,function(o,q){var p=new google.maps.LatLng(q.Latitude,q.Longitude);LoadPin(p,m(q));$("#localisationList").append($("<li/>").attr("class","localisationItem").append(m(q)).append($("<br/>")).append(l(q)))});function m(o){return"<a href=/Localisation/Details/"+o.ID+">"+o.Name+"</a>"}function l(o){return"<p>"+o.Description+"</p>"}};this.LoadSearchMap=LoadSearchMap;this.LoadDetailMap=LoadDetailMap;this.ClearMap=ClearMap;this.LoadPin=LoadPin;this.FindAddressOnMap=FindAddressOnMap;this.CenterSearchResults=CenterSearchResults;this.FitBoundsSearchResults=FitBoundsSearchResults};