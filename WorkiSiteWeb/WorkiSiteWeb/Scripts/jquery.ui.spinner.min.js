(function(a,q){var b="ui-state-active",i="ui-state-hover",c="ui-state-disabled",j=a.ui.keyCode,r=j.UP,d=j.DOWN,p=j.RIGHT,k=j.LEFT,o=j.PAGE_UP,n=j.PAGE_DOWN,h=j.HOME,e=j.END,m=a.browser.msie,l=a.browser.mozilla?"DOMMouseScroll":"mousewheel",f=".uispinner",s=[r,d,p,k,o,n,h,e,j.BACKSPACE,j.DELETE,j.TAB],g;a.widget("ui.spinner",{options:{min:null,max:null,allowNull:false,group:"",point:".",prefix:"",suffix:"",places:null,defaultStep:1,largeStep:10,mouseWheel:true,increment:"slow",className:null,showOn:"always",width:16,upIconClass:"ui-icon-triangle-1-n",downIconClass:"ui-icon-triangle-1-s",format:function(t,v){var u=this,w=/(\d+)(\d{3})/,x=((isNaN(t)?0:Math.abs(t)).toFixed(v))+"";for(x=x.replace(".",u.point);w.test(x)&&u.group;x=x.replace(w,"$1"+u.group+"$2")){}return(t<0?"-":"")+u.prefix+x+u.suffix},parse:function(u){var t=this;if(t.group=="."){u=u.replace(".","")}if(t.point!="."){u=u.replace(t.point,".")}return parseFloat(u.replace(/[^0-9\-\.]/g,""))}},_create:function(){var u=this,t=u.element,v=t.attr("type");if(!t.is("input")||((v!="text")&&(v!="number"))){console.error("Invalid target for ui.spinner");return}u._procOptions(true);u._createButtons(t);if(!t.is(":enabled")){u.disable()}},_createButtons:function(I){function z(W){return W=="auto"?0:parseInt(W)}var R=this,O=R.options,x=O.className,w=O.width,T=O.showOn,t=a.support.boxModel,A=I.outerHeight(),P=R.oMargin=z(I.css("margin-right")),V=R.wrapper=I.css({width:(R.oWidth=(t?I.width():I.outerWidth()))-w,marginRight:P+w,textAlign:"right"}).after('<span class="ui-spinner ui-widget"></span>').next(),u=R.btnContainer=a('<div class="ui-spinner-buttons"><div class="ui-spinner-up ui-spinner-button ui-state-default ui-corner-tr"><span class="ui-icon '+O.upIconClass+'">&nbsp;</span></div><div class="ui-spinner-down ui-spinner-button ui-state-default ui-corner-br"><span class="ui-icon '+O.downIconClass+'">&nbsp;</span></div></div>'),U,y,v,F,B,C,D,G,J,H,Q=I[0].dir=="rtl";if(x){V.addClass(x)}V.append(u.css({height:A,left:-w-P,top:(I.offset().top-V.offset().top)+"px"}));v=R.buttons=u.find(".ui-spinner-button");v.css({width:w-(t?v.outerWidth()-v.width():0),height:A/2-(t?v.outerHeight()-v.height():0)});U=v[0];y=v[1];F=v.find(".ui-icon");F.css({marginLeft:(v.innerWidth()-F.width())/2,marginTop:(v.innerHeight()-F.height())/2});u.width(v.outerWidth());if(T!="always"){u.css("opacity",0)}if(T=="hover"||T=="both"){v.add(I).bind("mouseenter"+f,function(){S(function(){D=true;if(!R.focused||(T=="hover")){R.showButtons()}})}).bind("mouseleave"+f,function E(){S(function(){D=false;if(!R.focused||(T=="hover")){R.hideButtons()}})})}v.hover(function(){R.buttons.removeClass(i);if(!O.disabled){a(this).addClass(i)}},function(){a(this).removeClass(i)}).mousedown(M).mouseup(N).mouseout(N);if(m){v.dblclick(function(){if(!O.disabled){R._change();R._doSpin((this===U?1:-1)*O.step)}return false}).bind("selectstart",function(){return false})}I.bind("keydown"+f,function(X){var W,Z,aa,Y=X.keyCode;if(X.ctrl||X.alt){return true}if(L(Y)){J=true}if(G){return false}switch(Y){case r:case o:W=1;Z=Y==o;break;case d:case n:W=-1;Z=Y==n;break;case p:case k:W=(Y==p)^Q?1:-1;break;case h:aa=R.options.min;if(aa!=null){R._setValue(aa)}return false;case e:aa=R.options.max;aa=R.options.max;if(aa!=null){R._setValue(aa)}return false}if(W){if(!G&&!O.disabled){keyDir=W;a(W>0?U:y).addClass(b);G=true;R._startSpin(W,Z)}return false}}).bind("keyup"+f,function(W){if(W.ctrl||W.alt){return true}if(L(j)){J=false}switch(W.keyCode){case r:case p:case o:case d:case k:case n:v.removeClass(b);R._stopSpin();G=false;return false}}).bind("keypress"+f,function(W){if(K(W.keyCode,W.charCode)){return false}}).bind("change"+f,function(){R._change()}).bind("focus"+f,function(){function W(){R.element.select()}m?W():setTimeout(W,0);R.focused=true;g=R;if(!D&&(T=="focus"||T=="both")){R.showButtons()}}).bind("blur"+f,function(){R.focused=false;if(!D&&(T=="focus"||T=="both")){R.hideButtons()}});function L(X){for(var W=0;W<s.length;W++){if(s[W]==X){return true}}return false}function K(Y,X){if(J){return false}var W=String.fromCharCode(X||Y),Z=R.options;if((W>="0")&&(W<="9")||(W=="-")){return false}if(((R.places>0)&&(W==Z.point))||(W==Z.group)){return false}return true}function S(W){if(B){if(W===C){return}clearTimeout(B)}C=W;B=setTimeout(X,100);function X(){B=0;W()}}function M(){if(!O.disabled){var X=R.element[0],W=(this===U?1:-1);X.focus();X.select();a(this).addClass(b);H=true;R._startSpin(W)}return false}function N(){if(H){a(this).removeClass(b);R._stopSpin();H=false}return false}},_procOptions:function(t){var A=this,u=A.element,y=A.options,x=y.min,v=y.max,B=y.step,z=y.places,w=-1,C;if(y.increment=="slow"){y.increment=[{count:1,mult:1,delay:250},{count:3,mult:1,delay:100},{count:0,mult:1,delay:50}]}else{if(y.increment=="fast"){y.increment=[{count:1,mult:1,delay:250},{count:19,mult:1,delay:100},{count:80,mult:1,delay:20},{count:100,mult:10,delay:20},{count:0,mult:100,delay:20}]}}if((x==null)&&((C=u.attr("min"))!=null)){x=parseFloat(C)}if((v==null)&&((C=u.attr("max"))!=null)){v=parseFloat(C)}if(!B&&((C=u.attr("step"))!=null)){if(C!="any"){B=parseFloat(C);y.largeStep*=B}}y.step=B=B||y.defaultStep;if((z==null)&&((C=B+"").indexOf(".")!=-1)){z=C.length-C.indexOf(".")-1}A.places=z;if((v!=null)&&(x!=null)){if(x>v){x=v}w=Math.max(Math.max(w,y.format(v,z,u).length),y.format(x,z,u).length)}if(t){A.inputMaxLength=u[0].maxLength}C=A.inputMaxLength;if(C>0){w=w>0?Math.min(C,w):C;C=Math.pow(10,w)-1;if((v==null)||(v>C)){v=C}C=-(C+1)/10+1;if((x==null)||(x<C)){x=C}}if(w>0){u.attr("maxlength",w)}y.min=x;y.max=v;A._change();u.unbind(l+f);if(y.mouseWheel){u.bind(l+f,A._mouseWheel)}},_mouseWheel:function(t){var u=a.data(this,"spinner");if(!u.options.disabled&&u.focused&&(g===u)){u._change();u._doSpin(((t.wheelDelta||-t.detail)>0?1:-1)*u.options.step);return false}},_setTimer:function(t,u,w){var x=this;x._stopSpin();x.timer=setInterval(v,t);function v(){x._spin(u,w)}},_stopSpin:function(){if(this.timer){clearInterval(this.timer);this.timer=0}},_startSpin:function(t,v){var x=this,w=x.options,u=w.increment;x._change();x._doSpin(t*(v?x.options.largeStep:x.options.step));if(u&&u.length>0){x.counter=0;x.incCounter=0;x._setTimer(u[0].delay,t,v)}},_spin:function(u,w){var x=this,v=x.options.increment,t=v[x.incCounter];x._doSpin(u*t.mult*(w?x.options.largeStep:x.options.step));x.counter++;if((x.counter>t.count)&&(x.incCounter<v.length-1)){x.counter=0;t=v[++x.incCounter];x._setTimer(t.delay,u,w)}},_doSpin:function(u){var t=this,v=t.curvalue;if(v==null){v=(u>0?t.options.min:t.options.max)||0}t._setValue(v+u)},_parseValue:function(){var t=this.element.val();return t?this.options.parse(t,this.element):null},_validate:function(w){var v=this.options,u=v.min,t=v.max;if((w==null)&&!v.allowNull){w=this.curvalue!=null?this.curvalue:u||t||0}if((t!=null)&&(w>t)){return t}else{if((u!=null)&&(w<u)){return u}else{return w}}},_change:function(){var v=this,w=v._parseValue(),u=v.options.min,t=v.options.max;if(!v.selfChange){if(isNaN(w)){w=v.curvalue}v._setValue(w,true)}},_setOption:function(t,u){a.Widget.prototype._setOption.call(this,t,u);this._procOptions()},increment:function(){this._doSpin(this.options.step)},decrement:function(){this._doSpin(-this.options.step)},showButtons:function(u){var t=this.btnContainer.stop();if(u){t.css("opacity",1)}else{t.fadeTo("fast",1)}},hideButtons:function(u){var t=this.btnContainer.stop();if(u){t.css("opacity",0)}else{t.fadeTo("fast",0)}this.buttons.removeClass(i)},_setValue:function(v,u){var t=this;t.curvalue=v=t._validate(v);t.element.val(v!=null?t.options.format(v,t.places,t.element):"");if(!u){t.selfChange=true;t.element.change();t.selfChange=false}},value:function(t){if(arguments.length){this._setValue(t);return this.element}return this.curvalue},enable:function(){this.buttons.removeClass(c);this.element[0].disabled=false;a.Widget.prototype.enable.call(this)},disable:function(){this.buttons.addClass(c).removeClass(i);this.element[0].disabled=true;a.Widget.prototype.disable.call(this)},destroy:function(t){this.wrapper.remove();this.element.unbind(f).css({width:this.oWidth,marginRight:this.oMargin});a.Widget.prototype.destroy.call(this)}})})(jQuery);